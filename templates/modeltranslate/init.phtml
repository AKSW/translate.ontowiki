<script type="text/javascript">
    $(document).ready(function(){
        // predicates stuff
        $(".predicates").change(function(){
            $("#all-predicates").attr('checked', false);
        });
        $("#all-predicates").change(function(){
            if($(this).attr("checked")){
                $(".predicates").each(function(){
                    $(this).attr("checked", false);
                });
            }
        });
        
        // languages stuff
        $(".languages").change(function(){
            $("#all-languages").attr('checked', false);
        });
        $("#all-languages").change(function(){
            if($(this).attr("checked")){
                $(".languages").each(function(){
                    $(this).attr("checked", false);
                });
            }
        });
        
        // send settings button
        $("#send-settings").click(function(){
            // init vars
            var preds = [];
            var langs = [];
            var pref = "en";
            
            // get predicates
            var allpreds = $("#all-predicates").attr("checked");
            $(".predicates").each(function(){
                if(allpreds){
                    preds.push( $(this).attr("id") );
                }else if( $(this).attr("checked") ){
                    preds.push( $(this).attr("id") );
                }
            });
            
            // get languages
            var alllangs = $("#all-languages").attr("checked");
            $(".languages").each(function(){
                if(alllangs){
                    langs.push( $(this).attr("id") );
                }else if( $(this).attr("checked") ){
                    langs.push( $(this).attr("id") );
                }
            });
            
            // get prefered language
            pref = $("#selectedBaseLanguage option:selected").val();
            
            // create request
            var request = {
                predicates: preds,
                languages: langs,
                prefered: pref
            };
            
            // send request
            $.post(urlBase+"modeltranslate/translate", request, function(data){
                $("#content").html(data);
            })
        })
    });
</script>

<!-- OPTIONS TABLE -->
<table>
<tr>
    <th>Predicates</th>
    <th>Languages</th>
    <th>Prefered source in</th>
</tr>
<tr>
    <td>
        <?php 
        $i = 0;
        foreach ($this->predicates as $predicate) { ?>
        <input type="checkbox" class="predicates" id="<?php echo $predicate; ?>">
        <a class="hasMenu" style="text-decoration:none;"
                                about="<?php echo $predicate; ?>"
                                href="<?php 
                                    $url = new OntoWiki_Url(array('route' => 'properties'), array('r'));
                                    $url->setParam('r', $predicate , true);
                                echo (string) $url ; ?>" >
                        <?php echo $this->titleHelper->getTitle($predicate, $this->locale); ?> 
        </a><br/>
        <?php
            $i++;
        } ?>
        <input type="radio" id="all-predicates" checked="true"> All predicates
    </td>
    <td>
        <?php 
        foreach ($this->languages as $key => $language) { ?>
            <input type="checkbox" class="languages" id="<?php echo $language->code; ?>"> <?php echo $language->label; ?> 
            <br/>
        <?php } ?>
        <input type="radio" id="all-languages" checked="true"> All languages
    </td>
    <td>
        <select id="selectedBaseLanguage" style="min-width:4em">
        <?php foreach ($this->languages as $languageKey => $languageValue) : ?>
            <option
                value="<?php echo $languageValue->code; ?>"
                <?php if (!empty($languageValue->default)) : ?>
                  selected
                <?php endif; ?>
            >
                <?php echo $languageValue->label; ?>
            </option>
        <?php endforeach; ?>
        </select>
    </td>
</tr>
<tr>
    <td colspan="3" style="text-align:right;">
        <button value="OK" id="send-settings">OK</button>
    </td>
</tr>
<!-- OPTIONS TABLE END -->
</table>
<div id="content">
</div>
